arm-bsp/firmware-image-juno: add xen support

This patch adds xen and dtbs binaries entries to images-r[012].txt files.
These images-r[012].txt files contain NOR filesystem entries details,
like file offset, name, path etc.

It also adds customization for uEnv.txt file, that allows to autoboot xen.

Upstream-Status: Inappropriate [configuration]
Signed-off-by: Kamil Dziezyk <kamil.dziezyk@arm.com>

diff -r -u a/images-r0.txt b/images-r0.txt
--- a/images-r0.txt	2020-11-13 17:26:27.945942230 +0100
+++ b/images-r0.txt	2020-11-13 17:26:43.221881902 +0100
@@ -1,7 +1,7 @@
 TITLE: Versatile Express Images Configuration File
 
 [IMAGES]
-TOTALIMAGES: 10                  ;Number of Images (Max: 32)
+TOTALIMAGES: 11                  ;Number of Images (Max: 32)
 
 NOR0UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR0ADDRESS: 0x00000000          ;Image Flash Address
@@ -24,7 +24,7 @@
 
 NOR3UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR3ADDRESS: 0x02900000          ;Image Flash Address
-NOR3FILE: \SOFTWARE\juno.dtb     ;Image File Name
+NOR3FILE: \SOFTWARE\XEN\juno.dtb ;Image File Name
 NOR3NAME: board.dtb              ;Specify target filename to preserve file extension
 NOR3LOAD: 00000000               ;Image Load Address
 NOR3ENTRY: 00000000              ;Image Entry Point
@@ -64,8 +64,13 @@
 NOR9UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR9ADDRESS: 0x02A80000          ;Image Flash Address
 NOR9NAME: uEnv.txt
-NOR9FILE: \SOFTWARE\uEnv.txt     ;Image File Name
+NOR9FILE: \SOFTWARE\uenvfile     ;Image File Name
 NOR9LOAD: 00000000               ;Image Load Address
 NOR9ENTRY: 00000000              ;Image Entry Point
 
-
+NOR10UPDATE: AUTO                ;Image Update:NONE/AUTO/FORCE
+NOR10ADDRESS: 0x03000000         ;Image Flash Address
+NOR10FILE: \SOFTWARE\XEN\xen     ;Image File Name
+NOR10NAME: xen
+NOR10LOAD: 00000000              ;Image Load Address
+NOR10ENTRY: 00000000             ;Image Entry Point
diff -r -u a/images-r1.txt b/images-r1.txt
--- a/images-r1.txt	2020-11-13 17:26:27.945942230 +0100
+++ b/images-r1.txt	2020-11-13 17:26:43.221881902 +0100
@@ -1,7 +1,7 @@
 TITLE: Versatile Express Images Configuration File
 
 [IMAGES]
-TOTALIMAGES: 10                  ;Number of Images (Max: 32)
+TOTALIMAGES: 11                  ;Number of Images (Max: 32)
 
 NOR0UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR0ADDRESS: 0x00000000          ;Image Flash Address
@@ -24,7 +24,7 @@
 
 NOR3UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR3ADDRESS: 0x02900000          ;Image Flash Address
-NOR3FILE: \SOFTWARE\juno-r1.dtb  ;Image File Name
+NOR3FILE: \SOFTWARE\XEN\juno-r1.dtb ;Image File Name
 NOR3NAME: board.dtb              ;Specify target filename to preserve file extension
 NOR3LOAD: 00000000               ;Image Load Address
 NOR3ENTRY: 00000000              ;Image Entry Point
@@ -64,8 +64,13 @@
 NOR9UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR9ADDRESS: 0x02A80000          ;Image Flash Address
 NOR9NAME: uEnv.txt
-NOR9FILE: \SOFTWARE\uEnv.txt     ;Image File Name
+NOR9FILE: \SOFTWARE\uenvfile     ;Image File Name
 NOR9LOAD: 00000000               ;Image Load Address
 NOR9ENTRY: 00000000              ;Image Entry Point
 
-
+NOR10UPDATE: AUTO                ;Image Update:NONE/AUTO/FORCE
+NOR10ADDRESS: 0x03000000         ;Image Flash Address
+NOR10FILE: \SOFTWARE\XEN\xen     ;Image File Name
+NOR10NAME: xen
+NOR10LOAD: 00000000              ;Image Load Address
+NOR10ENTRY: 00000000             ;Image Entry Point
diff -r -u a/images-r2.txt b/images-r2.txt
--- a/images-r2.txt	2020-11-13 17:26:27.949942214 +0100
+++ b/images-r2.txt	2020-11-13 17:26:43.221881902 +0100
@@ -1,7 +1,7 @@
 TITLE: Versatile Express Images Configuration File
 
 [IMAGES]
-TOTALIMAGES: 10                  ;Number of Images (Max: 32)
+TOTALIMAGES: 11                  ;Number of Images (Max: 32)
 
 NOR0UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR0ADDRESS: 0x00000000          ;Image Flash Address
@@ -24,7 +24,7 @@
 
 NOR3UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR3ADDRESS: 0x02900000          ;Image Flash Address
-NOR3FILE: \SOFTWARE\juno-r2.dtb  ;Image File Name
+NOR3FILE: \SOFTWARE\XEN\juno-r2.dtb ;Image File Name
 NOR3NAME: board.dtb              ;Specify target filename to preserve file extension
 NOR3LOAD: 00000000               ;Image Load Address
 NOR3ENTRY: 00000000              ;Image Entry Point
@@ -64,8 +64,13 @@
 NOR9UPDATE: AUTO                 ;Image Update:NONE/AUTO/FORCE
 NOR9ADDRESS: 0x02A80000          ;Image Flash Address
 NOR9NAME: uEnv.txt
-NOR9FILE: \SOFTWARE\uEnv.txt     ;Image File Name
+NOR9FILE: \SOFTWARE\uenvfile     ;Image File Name
 NOR9LOAD: 00000000               ;Image Load Address
 NOR9ENTRY: 00000000              ;Image Entry Point
 
-
+NOR10UPDATE: AUTO                ;Image Update:NONE/AUTO/FORCE
+NOR10ADDRESS: 0x03000000         ;Image Flash Address
+NOR10FILE: \SOFTWARE\XEN\xen     ;Image File Name
+NOR10NAME: xen
+NOR10LOAD: 00000000              ;Image Load Address
+NOR10ENTRY: 00000000             ;Image Entry Point
diff -r -u a/uEnv.txt b/uEnv.txt
--- a/uEnv.txt	2020-11-13 17:26:27.949942214 +0100
+++ b/uEnv.txt	2020-11-13 17:26:43.221881902 +0100
@@ -1,3 +1,5 @@
+xen_name=xen
+xen_addr=0x84000000
 uenvcmd=run mybootcmd
 mybootcmd=echo Loading custom boot command; \
 echo Loading kernel; \
@@ -7,5 +9,7 @@
 afs load  ${fdtfile} ${fdt_addr_r}; \
 if test $? -eq 1; then echo Loading ${fdt_alt_name} instead of ${fdtfile}; \
 afs load ${fdt_alt_name} ${fdt_addr_r}; fi; fdt addr ${fdt_addr_r}; fdt resize; \
-booti ${kernel_addr_r} - ${fdt_addr_r};
+echo Loading Xen; \
+afs load  ${xen_name} ${xen_addr}; \
+if test $? -eq 0; then echo Booting Xen; bootefi ${xen_addr} ${fdt_addr_r}; fi;
 
